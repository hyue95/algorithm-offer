<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>

//动态规划
var longestValidParentheses = function(s) {
  let dp = Array(s.length).fill(0)
  let maxLen = 0
  for(let i = 1; i < s.length; i ++){
    if(s[i] === ')'){
      if(s[i - 1] === '('){
        dp[i] = 2
        if(i - 2 >= 0){
          dp[i] = dp[i] + dp[i - 2]
        }
      }else if(dp[i - 1] > 0){
        if(i - 1 - dp[i - 1] >= 0 && s[i - 1 - dp[i - 1]] === '('){
          dp[i] = dp[i - 1] + 2
          if(i - dp[i - 1] - 2 >= 0){
            dp[i] = dp[i] + dp[i - dp[i - 1] - 2]
          } 
        }
      }
    }
    maxLen = Math.max(maxLen, dp[i])
  }
  return maxLen
};

//栈
var longestValidParentheses = function(s) {
  let maxLen = 0
  let stack = [-1]
  for(let i = 0; i < s.length; i ++){
    if(s[i] === '('){
      stack.push(i)
      continue
    }
    stack.pop()
    if(stack.length === 0){
      stack.push(i)
    }else{
      maxLen = Math.max(maxLen, i - stack[stack.length - 1])
    }
  }
  return maxLen
};

  </script>
</body>
</html>